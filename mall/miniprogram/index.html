<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="GuitarMall">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#1f2937">
  <title>GuitarMall 小程序原型</title>
  <link rel="apple-touch-icon" href="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=180&h=180&fit=crop&crop=center">
  <link rel="shortcut icon" href="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=32&h=32&fit=crop&crop=center">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="./assets/styles.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#1d4ed8',
            accent: '#f59e0b',
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 text-gray-900 pt-[env(safe-area-inset-top)] pb-[env(safe-area-inset-bottom)] select-none">
  <!-- 顶部栏（隐藏，保留DOM避免JS错误） -->
  <header class="hidden fixed top-0 inset-x-0 z-40 h-14 bg-white/90 backdrop-blur border-b border-gray-200 flex items-center px-4" aria-hidden="true">
    <div class="flex-1 font-semibold" id="mp-header-title">首页</div>
    <button class="text-gray-600 mr-3" id="mp-search-btn" aria-label="搜索">
      <i class="fa-solid fa-magnifying-glass text-lg"></i>
    </button>
    <button class="text-gray-600" id="mp-msg-btn" aria-label="消息">
      <i class="fa-regular fa-bell text-lg"></i>
    </button>
  </header>

  <!-- 页面容器 -->
  <main class="pt-0 pb-20">
    <!-- 首页 -->
    <section data-screen="home" class="block">
      <div class="px-4 py-3 space-y-4">
        <!-- 搜索栏 -->
        <div class="relative">
          <input id="mp-home-search" type="search" placeholder="搜索吉他/品牌/配件" class="w-full rounded-xl bg-gray-100 px-4 py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-primary" />
          <i class="fa-solid fa-magnifying-glass absolute right-3 top-1/2 -translate-y-1/2 text-gray-500"></i>
        </div>

        <!-- 轮播横幅（横向滚动） -->
        <div class="overflow-x-auto no-scrollbar -mx-4 px-4">
          <div class="flex gap-3 w-max" id="mp-banners">
            <!-- JS 注入banner -->
          </div>
        </div>

        <!-- 分类快捷入口 -->
        <div>
          <div class="flex items-center justify-between mb-2">
            <h2 class="font-semibold">热门分类</h2>
            <button data-link-screen="category" class="text-primary text-sm">全部分类 <i class="fa-solid fa-chevron-right"></i></button>
          </div>
          <div class="grid grid-cols-5 gap-3" id="mp-category-grid">
            <!-- JS 注入分类 -->
          </div>
        </div>

        <!-- 热门商品 -->
        <div>
          <div class="flex items-center justify-between mb-2">
            <h2 class="font-semibold">人气好物</h2>
            <button class="text-primary text-sm" id="mp-see-more-hot">更多 <i class="fa-solid fa-chevron-right"></i></button>
          </div>
          <div class="grid grid-cols-2 gap-3" id="mp-hot-products">
            <!-- JS 注入商品卡片 -->
          </div>
        </div>

        <!-- 商家视频 -->
        <div>
          <div class="flex items-center justify-between mb-2">
            <h2 class="font-semibold">商家视频</h2>
            <div class="flex items-center gap-3">
              <button class="text-primary text-sm" id="mp-open-feed">刷视频</button>
              <button class="text-primary text-sm" id="mp-see-more-video">更多 <i class="fa-solid fa-chevron-right"></i></button>
            </div>
          </div>
          <div class="overflow-x-auto no-scrollbar -mx-4 px-4">
            <div id="mp-video-row" class="flex gap-3 w-max"></div>
          </div>
        </div>
      </div>

      <!-- 在线客服浮标 -->
      <button id="mp-fab-chat" class="fixed bottom-24 right-4 h-12 w-12 rounded-full bg-primary text-white shadow-lg flex items-center justify-center">
        <i class="fa-solid fa-headset"></i>
      </button>
    </section>

    <!-- 分类/列表 -->
    <section data-screen="category" class="hidden">
      <div class="px-4 py-3 space-y-4">
        <div class="relative">
          <input id="mp-category-search" type="search" placeholder="搜索商品" class="w-full rounded-xl bg-gray-100 px-4 py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-primary" />
          <i class="fa-solid fa-magnifying-glass absolute right-3 top-1/2 -translate-y-1/2 text-gray-500"></i>
        </div>
        <div class="grid grid-cols-4 gap-2" id="mp-category-chips"></div>
        <div class="grid grid-cols-2 gap-3" id="mp-category-products"></div>
      </div>
    </section>

    <!-- 商品详情 -->
    <section data-screen="product-detail" class="hidden">
      <div class="relative">
        <div class="aspect-[4/3] bg-gray-200" id="mp-pd-images"></div>
        <button data-back class="absolute left-3 top-3 bg-black/40 text-white h-9 w-9 rounded-full flex items-center justify-center">
          <i class="fa-solid fa-arrow-left"></i>
        </button>
      </div>
      <div class="px-4 py-4 space-y-4">
        <div>
          <h1 id="mp-pd-title" class="text-lg font-semibold"></h1>
          <p id="mp-pd-sub" class="text-sm text-gray-500 mt-1"></p>
          <div class="mt-2 flex items-end gap-2">
            <span id="mp-pd-price" class="text-2xl font-bold text-primary"></span>
            <span id="mp-pd-origin" class="text-sm text-gray-400 line-through"></span>
          </div>
        </div>
        <div class="rounded-xl bg-white p-4 shadow-sm">
          <h3 class="font-semibold mb-2">规格与参数</h3>
          <div id="mp-pd-specs" class="text-sm text-gray-600 space-y-1"></div>
        </div>
        <div class="rounded-xl bg-white p-4 shadow-sm">
          <h3 class="font-semibold mb-2">用户评价</h3>
          <div id="mp-pd-reviews" class="space-y-3"></div>
        </div>
      </div>
      <div class="fixed bottom-16 inset-x-0 bg-white border-t border-gray-200 p-3 flex items-center gap-3">
        <button id="mp-pd-fav" class="h-11 w-11 rounded-xl border border-gray-200 flex items-center justify-center text-gray-600">
          <i class="fa-regular fa-heart"></i>
        </button>
        <button id="mp-pd-cart" class="flex-1 h-11 rounded-xl bg-gray-900 text-white">加入购物车</button>
        <button id="mp-pd-buy" class="flex-1 h-11 rounded-xl bg-primary text-white">立即购买</button>
      </div>
    </section>

    <!-- 购物车 -->
    <section data-screen="cart" class="hidden">
      <div class="px-4 py-3 space-y-3" id="mp-cart-list"></div>
      <div class="fixed bottom-16 inset-x-0 bg-white border-t border-gray-200 p-3 flex items-center gap-3">
        <div class="flex-1 text-sm text-gray-600">
          合计：<span id="mp-cart-total" class="text-lg font-semibold text-primary">¥0</span>
        </div>
        <button id="mp-cart-checkout" class="h-11 px-5 rounded-xl bg-primary text-white">去结算</button>
      </div>
    </section>

    <!-- 结算 -->
    <section data-screen="checkout" class="hidden">
      <div class="px-4 py-3 space-y-4">
        <div class="rounded-xl bg-white p-4 shadow-sm" id="mp-addr-card">
          <div class="flex items-center justify-between">
            <div>
              <div class="font-semibold">收货地址</div>
              <div id="mp-addr-text" class="text-sm text-gray-600">请选择地址</div>
            </div>
            <button id="mp-addr-choose" class="text-primary text-sm">选择 <i class="fa-solid fa-angle-right"></i></button>
          </div>
        </div>
        <div class="rounded-xl bg-white p-4 shadow-sm">
          <div class="font-semibold mb-2">配送方式</div>
          <div class="space-y-2" id="mp-shipping"></div>
        </div>
        <div class="rounded-xl bg-white p-4 shadow-sm">
          <div class="font-semibold mb-2">支付方式</div>
          <div class="space-y-2" id="mp-payment"></div>
        </div>
        <div class="rounded-xl bg-white p-4 shadow-sm">
          <div class="font-semibold mb-2">订单明细</div>
          <div id="mp-checkout-items" class="space-y-3"></div>
          <div class="flex items-center justify-between mt-3">
            <span>合计</span>
            <span id="mp-checkout-total" class="font-semibold text-primary">¥0</span>
          </div>
        </div>
      </div>
      <div class="fixed bottom-16 inset-x-0 bg-white border-t border-gray-200 p-3 flex items-center gap-3">
        <button data-back class="h-11 px-4 rounded-xl border border-gray-200">返回</button>
        <button id="mp-submit-order" class="flex-1 h-11 rounded-xl bg-primary text-white">提交订单</button>
      </div>
    </section>

    <!-- 订单列表 -->
    <section data-screen="orders" class="hidden">
      <div class="px-4 pt-3">
        <div class="grid grid-cols-3 gap-2" id="mp-order-tabs"></div>
      </div>
      <div class="px-4 py-3 space-y-3" id="mp-orders-list"></div>
    </section>

    <!-- 订单详情 -->
    <section data-screen="order-detail" class="hidden">
      <div class="px-4 py-4 space-y-4" id="mp-order-detail">
        <!-- JS 注入订单详情 -->
      </div>
      <div class="fixed bottom-16 inset-x-0 bg-white border-t border-gray-200 p-3 flex items-center gap-3" id="mp-order-actions"></div>
    </section>

    <!-- 视频列表 -->
    <section data-screen="videos" class="hidden">
      <div class="px-4 py-3 space-y-3" id="mp-videos-list"></div>
    </section>

    <!-- 视频详情 -->
    <section data-screen="video-detail" class="hidden">
      <div class="relative">
        <video id="mp-vd-player" class="w-full aspect-video bg-black" controls playsinline webkit-playsinline preload="metadata"></video>
        <button data-back class="absolute left-3 top-3 bg-black/40 text-white h-9 w-9 rounded-full flex items-center justify-center"><i class="fa-solid fa-arrow-left"></i></button>
      </div>
      <div class="p-4 space-y-1">
        <div id="mp-vd-title" class="text-base font-semibold"></div>
        <div id="mp-vd-merchant" class="text-sm text-gray-500"></div>
      </div>
      <div class="fixed bottom-16 inset-x-0 bg-white border-t border-gray-200 p-3 flex items-center gap-3">
        <button id="mp-vd-view" class="flex-1 h-11 rounded-xl border">查看商品</button>
        <button id="mp-vd-buy" class="flex-1 h-11 rounded-xl bg-primary text-white">立即购买</button>
      </div>
    </section>

    <!-- 视频竖刷 -->
    <section data-screen="video-feed" class="hidden relative bg-black">
      <div id="mp-feed" class="h-[calc(100vh-3.5rem-4rem)] overflow-y-scroll snap-y snap-mandatory no-scrollbar">
        <!-- JS 注入竖刷Item -->
      </div>
      <button data-back class="absolute left-3 top-16 bg-black/40 text-white h-9 px-3 rounded-full flex items-center gap-2"><i class="fa-solid fa-arrow-left"></i><span class="text-sm">返回</span></button>
    </section>

    <!-- 物流详情 -->
    <section data-screen="logistics" class="hidden">
      <div class="p-4 space-y-3">
        <div id="mp-logistics-summary" class="rounded-xl bg-white p-4 shadow-sm"></div>
        <div id="mp-logistics-steps" class="rounded-xl bg-white p-4 shadow-sm"></div>
      </div>
      <div class="fixed bottom-16 inset-x-0 p-3 bg-white border-t border-gray-200">
        <button data-back class="h-11 px-4 rounded-xl border">返回</button>
      </div>
    </section>

    <!-- 我的 -->
    <section data-screen="profile" class="hidden">
      <div class="p-4 space-y-4">
        <div class="rounded-2xl bg-gradient-to-r from-primary to-indigo-600 text-white p-4 flex items-center gap-4">
          <img id="mp-profile-avatar" class="h-14 w-14 rounded-full object-cover" src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=200&auto=format&fit=crop" alt="avatar" />
        	<div class="flex-1">
            <div id="mp-profile-name" class="font-semibold">Guitar Lover</div>
            <div class="text-white/80 text-sm">欢迎回来</div>
          </div>
          <button class="h-9 px-3 rounded-xl bg-white/15 border border-white/20">会员中心</button>
        </div>

        <div class="grid grid-cols-4 gap-3 text-center">
          <button data-link-screen="orders" class="rounded-xl bg-white p-3 shadow-sm">
            <i class="fa-solid fa-file-invoice text-primary"></i>
            <div class="text-xs mt-1">我的订单</div>
          </button>
          <button data-link-screen="favorites" class="rounded-xl bg-white p-3 shadow-sm">
            <i class="fa-regular fa-heart text-rose-500"></i>
            <div class="text-xs mt-1">收藏</div>
          </button>
          <button data-link-screen="addresses" class="rounded-xl bg-white p-3 shadow-sm">
            <i class="fa-solid fa-location-dot text-emerald-500"></i>
            <div class="text-xs mt-1">地址</div>
          </button>
          <button data-link-screen="coupons" class="rounded-xl bg-white p-3 shadow-sm">
            <i class="fa-solid fa-ticket text-amber-500"></i>
            <div class="text-xs mt-1">优惠券</div>
          </button>
        </div>

        <div class="rounded-xl bg-white divide-y shadow-sm">
          <button class="w-full text-left px-4 py-3 flex items-center gap-3">
            <i class="fa-regular fa-bell text-gray-500"></i><span>通知设置</span>
          </button>
          <button class="w-full text-left px-4 py-3 flex items-center gap-3">
            <i class="fa-solid fa-shield-halved text-gray-500"></i><span>隐私与安全</span>
          </button>
          <button class="w-full text-left px-4 py-3 flex items-center gap-3">
            <i class="fa-solid fa-circle-info text-gray-500"></i><span>关于</span>
          </button>
        </div>
      </div>
    </section>

    <!-- 收藏、地址、优惠券、客服等子页（恢复） -->
    <section data-screen="favorites" class="hidden">
      <div class="px-4 py-3 grid grid-cols-2 gap-3" id="mp-fav-list"></div>
    </section>
    <section data-screen="addresses" class="hidden">
      <div class="px-4 py-3 space-y-3" id="mp-addr-list"></div>
      <div class="fixed bottom-16 inset-x-0 p-3 bg-white border-t border-gray-200">
        <button id="mp-add-addr" class="w-full h-11 rounded-xl bg-primary text-white">新增地址</button>
      </div>
    </section>
    <section data-screen="coupons" class="hidden">
      <div class="px-4 py-3 space-y-3" id="mp-coupon-list"></div>
    </section>
    <section data-screen="support" class="hidden">
      <div class="flex flex-col h-[calc(100vh-4rem)]">
        <div class="flex-1 overflow-y-auto p-4 space-y-3" id="mp-chat-thread"></div>
        <div class="p-3 border-t bg-white flex items-center gap-2">
          <input id="mp-chat-input" class="flex-1 px-4 py-3 rounded-xl bg-gray-100 focus:outline-none" placeholder="输入消息..." />
          <button id="mp-chat-send" class="h-11 px-4 rounded-xl bg-primary text-white">发送</button>
        </div>
      </div>
    </section>
  </main>

  <!-- 底部导航 -->
  <nav class="fixed bottom-0 inset-x-0 h-16 bg-white/95 backdrop-blur border-t border-gray-200 z-40">
    <div class="grid grid-cols-5 h-full text-xs">
      <button data-nav="home" class="flex flex-col items-center justify-center text-primary">
        <i class="fa-solid fa-house"></i>
        <span>首页</span>
      </button>
      <button data-nav="video-feed" class="flex flex-col items-center justify-center text-gray-600">
        <i class="fa-solid fa-video"></i>
        <span>视频</span>
      </button>
      <button data-nav="category" class="flex flex-col items-center justify-center text-gray-600">
        <i class="fa-solid fa-layer-group"></i>
        <span>分类</span>
      </button>
      <button data-nav="cart" class="flex flex-col items-center justify-center text-gray-600 relative">
        <i class="fa-solid fa-cart-shopping"></i>
        <span>购物车</span>
        <span id="mp-cart-badge" class="absolute top-1 right-6 h-4 min-w-4 px-1 rounded-full bg-rose-500 text-white text-[10px] leading-4 hidden">0</span>
      </button>
      <button data-nav="profile" class="flex flex-col items-center justify-center text-gray-600">
        <i class="fa-regular fa-user"></i>
        <span>我的</span>
      </button>
    </div>
  </nav>

  <script src="./assets/app.js"></script>
</body>
</html> 