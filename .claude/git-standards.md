# Git 提交规范

## 📝 强制中文提交规范

**重要要求**: 所有 Git 提交信息**必须**使用中文，确保团队成员能够快速理解提交内容和项目历史。

## 🎯 提交信息格式

### 基本格式
```
<类型>: <简短描述>

<详细说明>（可选）
```

### 提交类型（中文）

| 类型 | 说明 | 示例 |
|------|------|------|
| **新增** | 添加新功能或新文件 | `新增: 用户登录页面组件` |
| **修复** | 修复Bug或问题 | `修复: 购物车数量计算错误` |
| **更新** | 更新现有功能或改进 | `更新: 优化商品列表加载性能` |
| **重构** | 代码重构，不改变功能 | `重构: 抽取公共API请求工具函数` |
| **样式** | 仅修改样式或UI | `样式: 调整导航栏响应式布局` |
| **文档** | 更新文档或注释 | `文档: 完善项目部署说明` |
| **配置** | 修改配置文件 | `配置: 更新webpack构建配置` |
| **测试** | 添加或修改测试 | `测试: 增加用户注册流程测试用例` |
| **删除** | 删除文件或功能 | `删除: 移除废弃的旧版本组件` |

## ✅ 良好的提交示例

### 单行提交（推荐）
```bash
git commit -m "新增: 商品详情页面轮播图组件"
git commit -m "修复: 移动端菜单按钮点击无响应问题"
git commit -m "更新: 提升首页加载速度和用户体验"
git commit -m "样式: 统一按钮组件的视觉设计风格"
```

### 多行提交（复杂功能）
```bash
git commit -m "新增: 完整的用户认证系统

- 实现用户注册和登录功能
- 添加JWT令牌管理
- 集成微信和支付宝第三方登录
- 完善用户权限验证中间件
- 添加密码加密和验证逻辑"
```

## ❌ 避免的提交方式

### 禁止使用英文
```bash
# ❌ 错误示例
git commit -m "Add user login page"
git commit -m "Fix shopping cart bug"
git commit -m "Update README.md"
```

### 禁止模糊描述
```bash
# ❌ 错误示例  
git commit -m "修改"
git commit -m "更新一些东西"
git commit -m "临时提交"
git commit -m "测试"
```

### 禁止过于简单
```bash
# ❌ 错误示例
git commit -m "改"
git commit -m "好了"
git commit -m "完成"
```

## 🔧 实施规范

### 提交前检查清单
- [ ] 提交信息使用中文
- [ ] 包含明确的类型标识
- [ ] 简短描述清晰具体（20-50字）
- [ ] 如有必要，包含详细说明
- [ ] 一次提交只关注一个主要变更

### 特殊情况处理

#### 紧急修复
```bash
git commit -m "紧急修复: 生产环境数据库连接超时问题"
```

#### 回滚操作
```bash
git commit -m "回滚: 撤销v2.1.0版本的用户认证更改"
```

#### 合并分支
```bash
git commit -m "合并: 将feature/payment-integration分支合并到主分支"
```

## 📊 提交频率和多次提交策略

### 强制多次提交的场景

**重要原则**: 复杂任务**必须**进行多次提交，确保每次提交都是独立、可理解的变更单元。

#### 1. 🔄 必须多次提交的情况

##### 大型功能开发
```bash
# 第一次提交 - 基础结构
git commit -m "新增: 用户认证模块基础架构和路由配置"

# 第二次提交 - 核心功能
git commit -m "新增: 用户登录和注册API接口实现"

# 第三次提交 - 前端界面
git commit -m "新增: 登录注册页面UI组件和表单验证"

# 第四次提交 - 集成测试
git commit -m "测试: 添加用户认证流程的集成测试用例"

# 第五次提交 - 样式优化
git commit -m "样式: 优化认证页面移动端响应式设计"
```

##### 问题修复过程
```bash
# 第一次提交 - 问题定位
git commit -m "修复: 定位购物车计算错误的根本原因"

# 第二次提交 - 核心修复
git commit -m "修复: 纠正商品价格计算逻辑中的小数点精度问题"

# 第三次提交 - 防护措施
git commit -m "更新: 添加价格计算的边界值检查和错误处理"

# 第四次提交 - 测试验证
git commit -m "测试: 增加购物车计算的单元测试覆盖"
```

##### 重构任务
```bash
# 第一次提交 - 提取公共函数
git commit -m "重构: 提取API请求的公共工具函数"

# 第二次提交 - 更新调用方式
git commit -m "重构: 更新所有组件使用新的API工具函数"

# 第三次提交 - 清理冗余代码
git commit -m "删除: 移除重构后不再使用的旧版本API代码"

# 第四次提交 - 优化性能
git commit -m "更新: 优化API请求缓存机制提升性能"
```

#### 2. 📝 多次提交的最佳实践

##### 逻辑分层提交
- **第一层**: 数据结构和模型定义
- **第二层**: 业务逻辑实现
- **第三层**: 用户界面开发
- **第四层**: 测试和验证
- **第五层**: 样式和体验优化

##### 功能递增提交
```bash
# 递增式功能开发示例
git commit -m "新增: 商品搜索基础框架"
git commit -m "新增: 实现关键词搜索功能"
git commit -m "新增: 添加商品分类筛选"
git commit -m "新增: 支持价格区间过滤"
git commit -m "新增: 集成搜索结果排序功能"
git commit -m "样式: 优化搜索界面用户体验"
```

#### 3. 🎯 提交粒度控制

##### 单一职责原则
每次提交应该只做一件事：
- ✅ **好的提交**: `修复: 解决用户头像上传失败的问题`
- ❌ **不好的提交**: `修复头像上传问题并优化页面样式和更新文档`

##### 原子性提交
每次提交都应该是完整且可用的：
- ✅ **原子提交**: 功能完整，代码可运行
- ❌ **非原子提交**: 功能残缺，依赖下次提交才能工作

### 推荐提交时机

#### 立即提交的情况
- **单个Bug修复**: 问题解决后立即提交
- **小功能完成**: 独立小功能开发完成
- **重要里程碑**: 完成阶段性目标
- **工作日结束**: 确保当天进展得到保存

#### 分步提交的情况
- **大型功能**: 按逻辑模块分步提交
- **复杂重构**: 按重构步骤分次提交
- **多文件修改**: 按文件功能分组提交
- **依赖变更**: 先提交依赖，再提交使用

### 避免的提交模式

#### 禁止的大杂烩提交
```bash
# ❌ 错误示例 - 包含太多不相关变更
git commit -m "新增用户模块、修复购物车bug、更新首页样式、添加测试用例"
```

#### 应该拆分为多次提交
```bash
# ✅ 正确示例 - 拆分为独立提交
git commit -m "新增: 用户注册和登录模块"
git commit -m "修复: 购物车商品数量计算错误"
git commit -m "样式: 更新首页布局和视觉设计"
git commit -m "测试: 添加用户模块单元测试"
```

## 🎯 自动化检查

### Git Hooks 集成
可以设置 pre-commit hook 检查提交信息格式：

```bash
#!/bin/sh
# .git/hooks/commit-msg

commit_msg=$(cat $1)

# 检查是否包含中文
if ! echo "$commit_msg" | grep -q '[\u4e00-\u9fa5]'; then
    echo "错误: 提交信息必须包含中文"
    exit 1
fi

# 检查是否包含类型标识
if ! echo "$commit_msg" | grep -qE '^(新增|修复|更新|重构|样式|文档|配置|测试|删除|紧急修复|回滚|合并):'; then
    echo "错误: 提交信息必须以规定的类型开头（新增/修复/更新/重构/样式/文档/配置/测试/删除）"
    exit 1
fi
```

## 📈 效果目标

通过中文提交规范：
- **可读性提升**: 团队成员快速理解提交内容
- **历史清晰**: 项目演进历程一目了然
- **维护效率**: 问题排查和代码回滚更加高效
- **团队协作**: 降低沟通成本，提升协作效率

## 🔍 提交历史示例

优秀的项目提交历史应该如下所示：
```
新增: 实现商品搜索和筛选功能
修复: 解决iOS设备上的支付页面显示问题  
更新: 优化图片压缩算法提升加载速度
样式: 统一整个应用的色彩设计规范
文档: 补充API接口使用说明和示例代码
配置: 配置生产环境的自动部署流程
```

这样的提交历史让任何团队成员都能快速了解项目的发展脉络和每次变更的目的。